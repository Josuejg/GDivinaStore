@model GraciaDivina.Models.ViewModels.ProductDetailsVM
@{
    ViewData["Title"] = Model.Nombre;
}

<div class="row g-4">
    <div class="col-12 col-md-6">
        <img class="img-fluid rounded"
             src="@(string.IsNullOrEmpty(Model.ImagenUrl) ? Url.Content("~/img/placeholder.svg") : Model.ImagenUrl)"
             alt="@Model.Nombre" />
    </div>

    <div class="col-12 col-md-6">
        <h1 class="h4 mb-1">@Model.Nombre</h1>
        @if (!string.IsNullOrEmpty(Model.Categoria))
        {
            <div class="text-muted mb-2">@Model.Categoria</div>
        }

        <div class="h5 mb-3">@Model.Precio.ToString("C")</div>

        @if (Model.Variantes.Any())
        {
            <form asp-controller="Carrito" asp-action="Agregar" method="post" class="mb-3">
                <div class="mb-2">
                    <label class="form-label">Variante</label>
                    <select name="varianteId" class="form-select">
                        @foreach (var v in Model.Variantes)
                        {
                            <option value="@v.VarianteID">@v.Display</option>
                        }
                    </select>
                </div>
                <div class="mb-3">
                    <label class="form-label">Cantidad</label>
                    <input type="number" name="cantidad" value="1" min="1" class="form-control" />
                </div>
                <button class="btn btn-primary">Agregar al carrito</button>
            </form>
        }
        else
        {
            <div class="alert alert-warning">Este producto no tiene variantes definidas aún.</div>
            <button class="btn btn-secondary" disabled>Agregar al carrito</button>
        }

        @if (!string.IsNullOrWhiteSpace(Model.Descripcion))
        {
            <hr />
            <p>@Model.Descripcion</p>
        }
    </div>
</div>

@if (Model.Relacionados.Any())
{
    <hr class="my-4" />
    <h2 class="h5">También te puede interesar</h2>
    <div class="row g-3">
        @foreach (var p in Model.Relacionados)
        {
            <div class="col-6 col-md-4 col-lg-3">
                @await Html.PartialAsync("_ProductCard", p)
            </div>
        }
    </div>
}
