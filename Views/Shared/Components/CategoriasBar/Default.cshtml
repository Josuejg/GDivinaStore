@model IEnumerable<GraciaDivina.Models.Categoria>
@{
    // Lee el querystring como string seguro
    var qId = ViewContext.HttpContext.Request.Query["categoriaId"].ToString();
    int? selId = int.TryParse(qId, out var tmp) ? tmp : (int?)null;
}

<nav class="gd-catnav d-flex align-items-center">
    <div class="nav-item dropdown me-2">
        <a class="nav-link dropdown-toggle px-2 text-white opacity-75"
           href="#" id="catDrop2" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            Categorías
        </a>

        <div class="dropdown-menu dropdown-menu-dark p-2 shadow" aria-labelledby="catDrop2">
            <div class="gd-cat-list">
                <a class="dropdown-item"
                   asp-controller="Catalogo" asp-action="Index">
                    Ver todo
                </a>
                <div class="dropdown-divider"></div>

                @foreach (var c in Model)
                {
                    <a class="dropdown-item"
                       asp-controller="Catalogo" asp-action="Index"
                       asp-route-categoriaId="@c.CategoriaID">
                        @c.Nombre
                    </a>
                }
            </div>
        </div>
    </div>

    <div class="gd-cat-inline">
        @foreach (var c in Model)
        {
            var isActive = selId.HasValue && selId.Value == c.CategoriaID;
            <a class="nav-link px-2 text-white @(selId == c.CategoriaID ? "active" : "opacity-75")"
               asp-controller="Catalogo"
               asp-action="Index"
               asp-route-categoriaId="@c.CategoriaID">
                @c.Nombre
            </a>
        }
    </div>

    <span class="flex-grow-1"></span>

    <a class="nav-link px-2 text-white opacity-75"
       asp-controller="Catalogo" asp-action="Index" asp-route-novedades="1">
        Novedades
    </a>
</nav>
